<!DOCTYPE html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>Address Book</title>
	<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<script type="text/javascript" charset="utf-8">
		var count = 0;
		var contacts = new Array();
		var indexes = new Array();
		var indx =0;
		function save()
		{
			person=new Object();
			person.firstname=document.getElementById('fname').value;
			person.lastname=document.getElementById('lname').value;
			person.phone=document.getElementById('phone').value;
			person.city=document.getElementById('city').value;
			contacts[count] = person;
			log(contacts[count].firstname);
			update(contacts[count]);
			count++;
			document.getElementById('fname').value="";
			document.getElementById('lname').value="";
			document.getElementById('phone').value="";
			document.getElementById('city').value="";
		}
		function update(pers){
			var container = document.getElementById('contactList');
			var new_element = document.createElement('tr');
			new_element.innerHTML = "<td>" + pers.firstname + "</td>";
			new_element.innerHTML += "<td>" + pers.lastname + "</td>";
			new_element.innerHTML += "<td>" + pers.phone + "</td>";
			new_element.innerHTML += "<td>" + pers.city + "</td>";
			log('add '+new_element.innerHTML);
			container.insertBefore(new_element, null);
		}
		function search(){
			var elem = document.getElementById('searchText').value;
			if(elem == ""){
				document.getElementById('errMsg').innerHTML = "Please Enter what to search for";
				return;
			}
			log('searching for '+elem);
			var i = 0;
			indx=0;
			var len = contacts.length;
			log('len='+len);
			for(;i<len;i++){
				if((contacts[i].firstname).indexOf(elem)!=-1 || (contacts[i].lastname).indexOf(elem)!=-1 || (contacts[i].phone).indexOf(elem)!=-1 || (contacts[i].city).indexOf(elem)!=-1){
					log('found at'+i);
					indexes[indx]=i;
					indx++;
				}
			}
			var container = document.getElementById('resultList');
			container.innerHTML="";
			var j =0;
			var heading = document.createElement('tr');
			heading.innerHTML = "<td>First Name</td><td>Last Name</td><td>Phone</td><td>City</td>";
			container.insertBefore(heading, null);
			for(;j<indx;j++){
				var new_element = document.createElement('tr');
				var pers = new Object();
				pers = contacts[indexes[j]];
				new_element.innerHTML = "<td>" + pers.firstname + "</td>";
				new_element.innerHTML += "<td>" + pers.lastname + "</td>";
				new_element.innerHTML += "<td>" + pers.phone + "</td>";
				new_element.innerHTML += "<td>" + pers.city + "</td>";
				log('add '+new_element.innerHTML);
				container.insertBefore(new_element, null);
			}
		}
		function sorting(b){
			log('b='+b);
			if(b=="firstname")
				contacts.sort(sort_by_name);
			else if(b=="lastname")
				contacts.sort(sort_by_lastname);
			else
				contacts.sort(sort_by_city);
			var container = document.getElementById('contactList');
			container.innerHTML="";
			var heading = document.createElement('tr');
			heading.innerHTML = "<td>First Name</td><td>Last Name</td><td>Phone</td><td>City</td>";
			container.insertBefore(heading, null);
			var x;
			for(x=0;x<contacts.length;x++){
				log(contacts[x].firstname);
				var pers = new Object();
				pers = contacts[x];
				var new_element = document.createElement('tr');
				new_element.innerHTML = "<td>" + pers.firstname + "</td>";
				new_element.innerHTML += "<td>" + pers.lastname + "</td>";
				new_element.innerHTML += "<td>" + pers.phone + "</td>";
				new_element.innerHTML += "<td>" + pers.city + "</td>";
				container.insertBefore(new_element, null);
			}
			
		} 
		var sort_by_name = function(a, b){
			if (a.firstname < b.firstname){
				return -1;
			} else {
				return 1;
			}
		};
		var sort_by_lastname = function(a, b){
			if (a.lastname < b.lastname){
				return -1;
			} else {
				return 1;
			}
		};
		var sort_by_city = function(a, b){
			if (a.city < b.city){
				return -1;
			} else {
				return 1;
			}
		};
		function deleteRes(){
			var y=0;
			log('in delete');
			for(;y<indx;y++){
				var found = indexes[y];
				log('found = '+found)
				contacts.splice(found,1);
			}
		}
		//utility functions
		function log(str){
			console.log(str);
		}
	</script>
</head>
<body id="" onload="" class="bg">
	<div class="left">
	<div>
		<label for="">First Name : </label><input type="text" name="" value="" id="fname">
		<label for="">Last Name : </label><input type="text" name="" value="" id="lname">
		<label for="">Phone :</label><input type="text" name="" value="" id="phone">
		<label for="">City : </label><input type="text" name="" value="" id="city">
		<p><input type="button" value="Save" onClick="save()"></p>
	</div>
	<div class="svdEntrs">
		<table border="1" class="svdEntrs" id="contactList">
		<tr>
		<td>First Name</td>
		<td>Last Name</td>
		<td>Phone</td>
		<td>City</td>
		</tr>
		</table>
	</div>
	</div>
	<div class="right">
	<div class="sort">
		Sort By : <br>
		<input type="radio" name="group1" value="firstname" checked="true" onclick="sorting('firstname');">First Name 
		<input type="radio" name="group1" value="lastname" onclick="sorting('lastname');">Last Name 
		<input type="radio" name="group1" value="city" onclick="sorting('city');">City<br><br>
		
	</div>
	<div class="search">
		Search for :<input type="text" name="" value="" id="searchText">
		<input type="button" value="Search" onClick="search()">
		<input type="button" value="delete" onClick="deleteRes()">
		<table border="1" class="srchRslts" id="resultList">
		<!-- <tr>
							<td>First Name</td>
							<td>Last Name</td>
							<td>Phone</td>
							<td>City</td>
							</tr> -->
		</table>
	</div>
	<p id="errMsg"></p>
	</div>
	
</body>